{% extends 'base.html' %}

{% block title %}Property Management{% endblock %}
{% block header %}Add Tenant Details{% endblock %}
{% block content %}

    <form method="POST" class="row g-3">
        <div class="col-12">
            <label for="name" class="form-label">Name</label>
            <input type="text" class="form-control" id="name" name="name" placeholder="John Doe">
        </div>
        <div class="col-md-6">
          <label for="contact_number" class="form-label">Contact No</label>
          <input type="text" class="form-control" id="contact_number" name="contact_number" placeholder="+971 50 100 1000">
        </div>
        <div class="col-md-6">
          <label for="email_address" class="form-label">Email Address</label>
          <input type="email" class="form-control" id="email_address" name="email_address">
        </div>
        <div class="col-md-6">
            <label for="passport_number" class="form-label">Passport No</label>
            <input type="text" class="form-control" id="passport_number" name="passport_number">
        </div>
          <div class="col-md-6">
            <label for="emirates_id_number" class="form-label">Emirates ID Number</label>
            <input type="text" class="form-control" id="emirates_id_number" name="emirates_id_number">
        </div>
        <div class="col-md-6">
            <label for="contract_start_date" class="form-label">Contract Start Date</label>
            <input type="date" class="form-control" id="contract_start_date" name="contract_start_date">
        </div>
          <div class="col-md-6">
            <label for="contract_end_date" class="form-label">Contract End Date</label>
            <input type="date" class="form-control" id="contract_end_date" name="contract_end_date">
        </div>
        <div class="col-md-6">
            <label for="rental_amount" class="form-label">Rental Amount</label>
            <input type="tex" class="form-control" id="rental_amount" name="rental_amount">
        </div>
        <div class="col-md-3">
            <label for="no_of_cheques" class="form-label">No Of Cheques</label>
            <input type="text" class="form-control" id="no_of_cheques" name="no_of_cheques" min="1" max="12">
        </div>
        <div class="col-md-3">
            <label for="security_deposit" class="form-label">Deposit</label>
            <input type="tex" class="form-control" id="security_deposit" name="security_deposit">
        </div>
        <div class="col-md-4">
          <label for="inputState" class="form-label">Property</label>
          <select id="property_id" name="property_id" class="form-select" required>
            {% for property in properties %}
              {% if property.tenant %}
                {% for tenant in property.tenant %}
                  <option value="{{ property.id }}" disabled>{{ property.id }} (Occupied by {{ tenant.name }})</option>
                {% endfor %}
              {% else %}
                <option value="{{ property.id }}">{{ property.id }}</option>
              {% endif %}
            {% endfor %}
          </select>
        </div>
        <div class="col-md-4">
            <label for="tenant_id" class="form-label">Tenant ID</label>
            <input type="tex" class="form-control" id="tenant_id" name="tenant_id" required>
        </div>
        <div class="col-md-6">
          <button type="button" class="btn btn-primary" id="add_cheques_button">Add Cheques</button>
        </div>
        <div id="cheque_fields" class="col-12">
        </div>
        <button type="submit" class="btn btn-primary">Add Tenant</button>
      </form>

      <script>
        const addChequesButton = document.getElementById('add_cheques_button');
        const chequeFieldsDiv = document.getElementById('cheque_fields');
        const maxCheques = 12;
    
        addChequesButton.addEventListener('click', () => {
            const numCheques = parseInt(document.getElementById('no_of_cheques').value);
    
            if (isNaN(numCheques) || numCheques < 1 || numCheques > maxCheques) {
                alert(`Please enter a number between 1 and ${maxCheques}.`);
                return;
            }
    
            chequeFieldsDiv.innerHTML = ''; // Clear existing fields
    
            for (let i = 0; i < numCheques; i++) {
                // Create a new div for each cheque
                const chequeGroup = document.createElement('div');
                chequeGroup.classList.add('row', 'mb-3');
    
                chequeGroup.innerHTML = `
                    <h4 class="col-12">Cheque ${i + 1}</h4>
                    <div class="col-md-3">
                        <label>Cheque Number:</label>
                        <input type="text" class="form-control" name="cheques[${i}][cheque_number]" required>
                    </div>
                    <div class="col-md-3">
                        <label>Amount:</label>
                        <input type="number" step="0.01" class="form-control" name="cheques[${i}][amount]" required>
                    </div>
                    <div class="col-md-3">
                        <label>Issue Date:</label>
                        <input type="date" class="form-control" name="cheques[${i}][issue_date]" required>
                    </div>
                    <div class="col-md-3">
                        <label>Due Date:</label>
                        <input type="date" class="form-control" name="cheques[${i}][due_date]" required>
                    </div>
                `;
    
                // Append the new group to the container
                chequeFieldsDiv.appendChild(chequeGroup);
            }
        });
    </script>
    
    
{% endblock %}
